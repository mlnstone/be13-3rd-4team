<template>
    <!-- <svg xmlns="http://www.w3.org/2000/svg" class="d-none">
        <symbol id="bootstrap" viewBox="0 0 118 94">
            <title>Bootstrap</title>
            <path fill-rule="evenodd" clip-rule="evenodd"
                d="M24.509 0c-6.733 0-11.715 5.893-11.492 12.284.214 6.14-.064 14.092-2.066 20.577C8.943 39.365 5.547 43.485 0 44.014v5.972c5.547.529 8.943 4.649 10.951 11.153 2.002 6.485 2.28 14.437 2.066 20.577C12.794 88.106 17.776 94 24.51 94H93.5c6.733 0 11.714-5.893 11.491-12.284-.214-6.14.064-14.092 2.066-20.577 2.009-6.504 5.396-10.624 10.943-11.153v-5.972c-5.547-.529-8.934-4.649-10.943-11.153-2.002-6.484-2.28-14.437-2.066-20.577C105.214 5.894 100.233 0 93.5 0H24.508zM80 57.863C80 66.663 73.436 72 62.543 72H44a2 2 0 01-2-2V24a2 2 0 012-2h18.437c9.083 0 15.044 4.92 15.044 12.474 0 5.302-4.01 10.049-9.119 10.88v.277C75.317 46.394 80 51.21 80 57.863zM60.521 28.34H49.948v14.934h8.905c6.884 0 10.68-2.772 10.68-7.727 0-4.643-3.264-7.207-9.012-7.207zM49.948 49.2v16.458H60.91c7.167 0 10.964-2.876 10.964-8.281 0-5.406-3.903-8.178-11.425-8.178H49.948z">
            </path>
        </symbol>
    </svg> -->
    <header class="d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
            <img src="@/assets/moyobom.svg" alt="ëª¨ìš”ë´„ ì•„ì´ì½˜" />
            <span class="fs-4">MOYOBOM</span>
        </a>

        <ul class="nav nav-pills">
            <li class="nav-item">
                <RouterLink class="nav-link" style="color: red;">ë°°í¬ í…ŒìŠ¤íŠ¸ìš©</RouterLink>
            </li>
            <li class="nav-item">
                <!-- í™”ë©´ ì „í™˜ì— í•„ìš”í•œ ë§í¬ë¥¼ ìƒì„±í•œë‹¤. -->
                <!-- <RouterLink to="/">HOME</RouterLink> -->
                <!--
                ëª…ëª…ëœ ë¼ìš°í„°ì˜ ê²½ìš° v-bindë¥¼ ì´ìš©í•´ì„œ to ì†ì„±ì— ë¬¸ìì—´ì´ ì•„ë‹Œ ê°ì²´ë¥¼ ë°”ì¸ë”©í•´ì•¼ í•œë‹¤.
                -->
                <RouterLink class="nav-link" :to="{ name: 'home' }">HOME</RouterLink>
            </li>
            <!-- <li class="nav-item"> -->
            <!-- <RouterLink to="/departments">í•™ê³¼ ëª©ë¡ ì¡°íšŒ</RouterLink> -->
            <!-- <RouterLink class="nav-link" :to="{name: 'postDetail'}">í•™ê³¼ ëª©ë¡ ì¡°íšŒ</RouterLink> -->
            <!-- </li> -->
            <!-- <li class="nav-item"> -->
            <!-- <RouterLink to="/departments/1">í•™ê³¼ ìƒì„¸ ì¡°íšŒ</RouterLink> -->
            <!-- <RouterLink class="nav-link" :to="{name: 'departments/no', params: {no: '033'}}">í•™ê³¼ ìƒì„¸ ì¡°íšŒ</RouterLink> -->
            <!-- </li> -->
            <!-- <li class="nav-item"> -->
            <!-- <RouterLink to="/departments/add">í•™ê³¼ ë“±ë¡</RouterLink> -->
            <!-- <RouterLink class="nav-link" :to="{name: 'departments/add'}">í•™ê³¼ ë“±ë¡</RouterLink> -->
            <!-- </li> -->
            <!-- ìª½ì§€ -->
            <li class="nav-item">
                <RouterLink class="nav-link" :to="{ name: 'posts' }"> ê²Œì‹œíŒ </RouterLink>
            </li>
            <li class="nav-item">
                <RouterLink class="nav-link" :to="{ name: 'messages' }">ìª½ì§€</RouterLink>
            </li>
            <!-- <li class="nav-item">
                <RouterLink class="nav-link" :to="{name: 'messages/add'}">ìª½ì§€ ë“±ë¡</RouterLink>
            </li> -->
            <!-- í”„ë¡œì íŠ¸ -->
            <li class="nav-item">
                <RouterLink class="nav-link" :to="{ name: 'projects' }">í”„ë¡œì íŠ¸</RouterLink>
            </li>
            <!--            <li class="nav-item">-->
            <!--                <RouterLink class="nav-link" :to="{name: 'projects/no', params: {no: '033'}}">í”„ë¡œì íŠ¸ ìƒì„¸ ì¡°íšŒ</RouterLink>-->
            <!--            </li>-->
            <!--            <li class="nav-item">-->
            <!--                <RouterLink class="nav-link" :to="{name: 'projects/add'}">í”„ë¡œì íŠ¸ ë“±ë¡</RouterLink>-->
            <!--            </li>-->
            <!-- íŒ€ -->
            <!-- <li class="nav-item">
                <RouterLink class="nav-link" :to="{ name: 'teams' }">íŒ€</RouterLink>
            </li> -->
            <!--            <li class="nav-item">-->
            <!--                <RouterLink class="nav-link" :to="{name: 'teams/no', params: {no: '033'}}">íŒ€ ìƒì„¸ ì¡°íšŒ</RouterLink>-->
            <!--            </li>-->
            <!--            <li class="nav-item">-->
            <!--                <RouterLink class="nav-link" :to="{name: 'teams/add'}">íŒ€ ë“±ë¡</RouterLink>-->
            <!--            </li>-->
            <!-- ì‹ ê³  -->
            <!--            <li class="nav-item">-->
            <!--               ê´€ë¦¬ì -->
            <!--                <RouterLink class="nav-link" :to="{name: 'reports'}">ì‹ ê³  ëª©ë¡ ì¡°íšŒ</RouterLink>-->
            <!--            </li>-->
            <li class="nav-item">
                <RouterLink class="nav-link" :to="{ name: 'reports/add' }">ì‹ ê³  ë“±ë¡</RouterLink>
            </li>
            <!-- ê²Œì‹œê¸€ -->
            <!--            <li class="nav-item">-->
            <!--                <RouterLink class="nav-link" :to="{name: 'posts/add'}">ê²Œì‹œê¸€ ë“±ë¡</RouterLink>-->
            <!--            </li>-->
            <!-- ë§ˆì´í˜ì´ì§€ -->
            <li class="nav-item">
                <RouterLink class="nav-link" :to="{ name: 'mypage' }">{{ userInfo.username }}</RouterLink>
            </li>

            <!-- ğŸ”” ì•Œë¦¼ ë²„íŠ¼ & ì•Œë¦¼ ë°•ìŠ¤ -->
            <li class="nav-item position-relative">
                <button class="btn" :class="[{ 'btn-warning': !showAlert, 'btn-danger animate-blink': showAlert }]"
                    @click="showNoti = !showNoti">
                    <i class="fi fi-ss-bell-ring" style="color: #e67700;"></i>
                </button>
                <div class="position-absolute end-0 mt-2" :style="{ display: showNoti ? 'block' : 'none' }">
                    <NotificationBox />
                </div>
            </li>
        </ul>
        <div class="col-md-3 text-end">
            <button type="button" class="btn btn-outline-secondary" @click="logout">Logout</button>
        </div>
    </header>
</template>

<script setup>
import { useAuthStore } from '@/stores/auth';
import { computed, ref, onMounted } from "vue";
import NotificationBox from '@/views/common/NotificationBox.vue';
import { eventBus } from '@/utils/eventBus';

const authStore = useAuthStore();
const userInfo = authStore.userInfo;

const logout = () => {
    if (confirm('ì •ë§ë¡œ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {

        authStore.logout();
    }
};

// ê´€ë¦¬ìì¼ ë•Œë§Œ ê´€ë¦¬ìí˜ì´ì§€ íƒ­ ë³´ì´ê²Œ í•˜ê¸° ìœ„í•¨ 
const isAdmin = computed(() => authStore.userInfo?.role === 'ADMIN');


// ì•Œë¦¼
const isNavShow = ref(false);
const showNoti = ref(false);
const showAlert = ref(false);

// ğŸ”” NotificationBox.vueì—ì„œ ì•Œë¦¼ì´ ì˜¤ë©´ ì´ë²¤íŠ¸ ìˆ˜ì‹ 
onMounted(() => {
    eventBus.on('new-notification', () => {
        showAlert.value = true;
        setTimeout(() => {
            showAlert.value = false;
        }, 3000) // 3ì´ˆ ê¹œë¹¡ì„
    });
});
</script>

<style scoped>
@import url('https://cdn-uicons.flaticon.com/2.6.0/uicons-solid-straight/css/uicons-solid-straight.css');

/* í˜„ì¬ URLê³¼ ì •í™•í•˜ê²Œ ì¼ì¹˜í•˜ëŠ” ê²½ìš°ì—ë§Œ ìŠ¤íƒ€ì¼ì´ ì ìš©ëœë‹¤. */
.router-link-exact-active {
    color: rgb(108, 117, 125);
}

/* ì•Œë¦¼ ìŠ¤íƒ€ì¼ */

@keyframes blink {
    0% {
        opacity: 1;
    }

    50% {
        opacity: 0;
    }

    100% {
        opacity: 1;
    }
}

.animate-blink {
    animation: blink 0.7s ease-in-out 3;
}
</style>